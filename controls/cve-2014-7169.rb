# encoding: utf-8
# copyright: 2017, Galen Emery

title 'CVE-2014-7169'

control 'CVE-2014-7169' do                        # A unique ID for this control
  impact 1.0                                # The criticality, if this control fails.
  title 'CVE-2014-7169 (Shellshock)'             # A human-readable title
  desc 'GNU Bash through 4.3 bash43-025 processes trailing strings after certain malformed function definitions in the values of environment variables, which allows remote attackers to write to files or possibly have unknown other impact via a crafted environment, as demonstrated by vectors involving the ForceCommand feature in OpenSSH sshd, the mod_cgi and mod_cgid modules in the Apache HTTP Server, scripts executed by unspecified DHCP clients, and other situations in which setting the environment occurs across a privilege boundary from Bash execution. NOTE: this vulnerability exists because of an incomplete fix for CVE-2014-6271.'
  describe bash("x='() { :;}; echo VULNERABLE' bash -c :") do
    its('stdout') { should_not match "VULNERABLE" }
  end
  describe package('bash') do
      its('version') { should eq '4.2.46-28.el7' }
  end
end


